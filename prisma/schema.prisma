generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  address   String?
  birthDate DateTime?
  rg        String?
  cpfCnpj   String?
  phone     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  actions   Action[]
}

model Sensors {
  id           Int      @id @default(autoincrement())
  temperature  Float
  humidity     Float
  luminosity   Float
  rationWeight Float
  waterLevel   Boolean
  createdAt    DateTime @default(now())
}

model Config {
  id           Int      @id @default(autoincrement())
  mode         String
  light        Json     // Configuração de iluminação (control, ldrThreshold, onTime, offTime)
  temperature  Json     // Configuração de temperatura (min, max)
  ration       Json     // Configuração de ração (minWeight, maxWeight)
  saveInterval Int      @default(5) // Intervalo em segundos para salvar dados no banco
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Action {
  id        Int      @id @default(autoincrement())
  userId    Int
  user      User     @relation(fields: [userId], references: [id])
  system    String
  action    String
  quantity  Float?
  createdAt DateTime @default(now())
}

model Alert {
  id        Int      @id @default(autoincrement())
  type      String   // ex: RATION_LOW, RATION_HIGH, PUMP_TIMEOUT, etc
  message   String?
  data      Json?    // dados adicionais do alerta (currentWeight, minWeight, etc)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
